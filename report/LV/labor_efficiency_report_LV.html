<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LV门店人工效率分析报告</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', 'SimHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
        }
        .section {
            background: white;
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .section h2 {
            color: #667eea;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-top: 0;
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .metric-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .metric-card .value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }
        .metric-card .label {
            font-size: 1.1em;
            color: #666;
        }
        .chart-container {
            text-align: center;
            margin: 30px 0;
        }
        .chart-container img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        table th, table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        table th {
            background-color: #667eea;
            color: white;
            font-weight: bold;
        }
        table tr:hover {
            background-color: #f5f5f5;
        }
        .highlight {
            background-color: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
            border-radius: 4px;
        }
        .insight {
            background-color: #d1ecf1;
            padding: 15px;
            border-left: 4px solid #0c5460;
            margin: 15px 0;
            border-radius: 4px;
        }
        .recommendation {
            background-color: #d4edda;
            padding: 15px;
            border-left: 4px solid #28a745;
            margin: 15px 0;
            border-radius: 4px;
        }
        .footer {
            text-align: center;
            color: #666;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
        }
        .chart-tabs {
            margin-top: 20px;
        }
        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #ddd;
        }
        .tab-button {
            padding: 12px 24px;
            background: #f0f0f0;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            color: #666;
            transition: all 0.3s;
        }
        .tab-button:hover {
            background: #e0e0e0;
        }
        .tab-button.active {
            background: white;
            color: #667eea;
            border-bottom-color: #667eea;
        }
        .confirm-btn {
            padding: 8px 20px;
            font-size: 1em;
            border: 2px solid rgba(255,255,255,0.8);
            border-radius: 5px;
            background: rgba(255,255,255,0.9);
            color: #667eea;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        .confirm-btn:hover {
            background: white;
            border-color: white;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .confirm-btn:active {
            transform: translateY(0);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .chart-image {
            text-align: center;
            margin: 20px 0;
        }
        .chart-image img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script>
        // Global variables
        var allData = [];
        var chartInstances = {};
        var currentFilteredData = [];
        
        // Initialize date selectors with default values
        document.addEventListener('DOMContentLoaded', function() {
            // Load all data
            try {
                var dataElement = document.getElementById('allData');
                if (dataElement) {
                    allData = JSON.parse(dataElement.textContent);
                }
            } catch (e) {
                console.error('Error loading data:', e);
                return;
            }
            
            var startSelect = document.getElementById('startDate');
            var endSelect = document.getElementById('endDate');
            
            if (allData && allData.length > 0) {
                // Sort data by start_date to ensure correct first and last dates
                var sortedData = allData.slice().sort(function(a, b) {
                    return new Date(a.start_date) - new Date(b.start_date);
                });
                // Set default to first and last dates
                var firstDate = sortedData[0].start_date.split('T')[0];
                var lastDate = sortedData[sortedData.length - 1].start_date.split('T')[0];
                startSelect.value = firstDate;
                endSelect.value = lastDate;
                
                // Wait for Chart.js to be ready, then update
                function initializeCharts() {
                    if (typeof Chart !== 'undefined') {
                        updateDateRange();
                    } else {
                        setTimeout(initializeCharts, 100);
                    }
                }
                initializeCharts();
            }
        });
        
        function switchTab(tabName, buttonElement) {
            // Hide all tabs
            var tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remove active from all buttons
            var buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab
            document.getElementById('tab-' + tabName).classList.add('active');
            buttonElement.classList.add('active');
            
            // Update charts for the active tab with current filtered data
            updateCharts(currentFilteredData.length > 0 ? currentFilteredData : allData);
        }
        
        function filterTable() {
            var filter = document.getElementById('periodFilter').value;
            var table = document.getElementById('periodTable');
            var rows = table.getElementsByTagName('tr');
            
            // Skip header row (index 0)
            for (var i = 1; i < rows.length; i++) {
                var row = rows[i];
                var period = row.getAttribute('data-period');
                
                if (filter === 'all' || period === filter) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            }
        }
        
        function updateDateRange() {
            var startDate = document.getElementById('startDate').value;
            var endDate = document.getElementById('endDate').value;
            
            if (!startDate || !endDate) {
                return;
            }
            
            // Filter data by date range
            var filteredData = allData.filter(function(item) {
                var itemStart = item.start_date.split('T')[0];
                return itemStart >= startDate && itemStart <= endDate;
            });
            
            // Store current filtered data for use by switchTab
            currentFilteredData = filteredData;
            
            // Update date range display
            var startDisplay = document.querySelector('#startDate option:checked').text;
            var endDisplay = document.querySelector('#endDate option:checked').text;
            document.getElementById('dateRangeDisplay').textContent = startDisplay + ' - ' + endDisplay;
            
            // Update all sections with filtered data
            updateSummaryMetrics(filteredData);
            updateKeyMetrics(filteredData);
            updatePeriodTable(filteredData);
            updateMonthlySummary(filteredData);
            updateInsights(filteredData);
            updateCharts(filteredData);
        }
        
        function updateSummaryMetrics(data) {
            if (data.length === 0) return;
            
            var totalSales = data.reduce((sum, item) => sum + (item.net_sales || 0), 0);
            var totalLaborCost = data.reduce((sum, item) => sum + (item.total_labor_cost || 0), 0);
            var avgLaborCostPct = totalSales > 0 ? (totalLaborCost / totalSales * 100) : 0;
            var totalHours = data.reduce((sum, item) => sum + (item.total_Labor_hour || 0), 0);
            var avgSplh = data.reduce((sum, item) => sum + (item.sales_per_labor_hour || 0), 0) / data.length;
            
            // Update metric cards
            var cards = document.querySelectorAll('.metric-card .value');
            if (cards.length >= 5) {
                cards[0].textContent = '$' + totalSales.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                cards[1].textContent = '$' + totalLaborCost.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                cards[2].textContent = avgLaborCostPct.toFixed(2) + '%';
                cards[3].textContent = totalHours.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                cards[4].textContent = '$' + avgSplh.toFixed(2);
            }
        }
        
        function updateKeyMetrics(data) {
            if (data.length === 0) return;
            
            var laborCostPcts = data.map(item => item.labor_cost_pct || 0);
            var splhs = data.map(item => item.sales_per_labor_hour || 0);
            var avgLaborCostPct = laborCostPcts.reduce((a, b) => a + b, 0) / laborCostPcts.length;
            var minLaborCostPct = Math.min(...laborCostPcts);
            var maxLaborCostPct = Math.max(...laborCostPcts);
            var minPeriod = data[laborCostPcts.indexOf(minLaborCostPct)];
            var maxPeriod = data[laborCostPcts.indexOf(maxLaborCostPct)];
            var stdDev = Math.sqrt(laborCostPcts.reduce((sq, n) => sq + Math.pow(n - avgLaborCostPct, 2), 0) / laborCostPcts.length);
            var avgSplh = splhs.reduce((a, b) => a + b, 0) / splhs.length;
            var maxSplh = Math.max(...splhs);
            var minSplh = Math.min(...splhs);
            var maxSplhPeriod = data[splhs.indexOf(maxSplh)];
            var minSplhPeriod = data[splhs.indexOf(minSplh)];
            var avgOvertimePct = data.reduce((sum, item) => sum + (item.overtime_pct || 0), 0) / data.length;
            var totalOvertime = data.reduce((sum, item) => sum + (item.OT_hour || 0), 0);
            var avgHC = data.reduce((sum, item) => sum + (item.HC || 0), 0) / data.length;
            
            // Update key metrics table
            var table = document.getElementById('keyMetricsTable');
            if (table) {
                var rows = table.getElementsByTagName('tr');
                if (rows.length > 1) rows[1].cells[1].textContent = data.length + ' 个';
                if (rows.length > 2) rows[2].cells[1].textContent = avgLaborCostPct.toFixed(2) + '%';
                if (rows.length > 3) rows[3].cells[1].textContent = minLaborCostPct.toFixed(2) + '% (时间段: ' + (minPeriod ? minPeriod.Period : '') + ')';
                if (rows.length > 4) rows[4].cells[1].textContent = maxLaborCostPct.toFixed(2) + '% (时间段: ' + (maxPeriod ? maxPeriod.Period : '') + ')';
                if (rows.length > 5) rows[5].cells[1].textContent = stdDev.toFixed(2) + '%';
                if (rows.length > 6) rows[6].cells[1].textContent = '$' + avgSplh.toFixed(2);
                if (rows.length > 7) rows[7].cells[1].textContent = '$' + maxSplh.toFixed(2) + ' (时间段: ' + (maxSplhPeriod ? maxSplhPeriod.Period : '') + ')';
                if (rows.length > 8) rows[8].cells[1].textContent = '$' + minSplh.toFixed(2) + ' (时间段: ' + (minSplhPeriod ? minSplhPeriod.Period : '') + ')';
                if (rows.length > 9) rows[9].cells[1].textContent = avgOvertimePct.toFixed(2) + '%';
                if (rows.length > 10) rows[10].cells[1].textContent = totalOvertime.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}) + ' 小时';
                if (rows.length > 11) rows[11].cells[1].textContent = avgHC.toFixed(1) + ' 人';
            }
        }
        
        function updatePeriodTable(data) {
            var tbody = document.getElementById('periodTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // Calculate change percentages
            var sortedData = data.slice().sort((a, b) => new Date(a.start_date) - new Date(b.start_date));
            
            for (var i = 0; i < sortedData.length; i++) {
                var row = sortedData[i];
                var otChange = 0;
                var costChange = 0;
                
                if (i > 0) {
                    var prevRow = sortedData[i-1];
                    if (prevRow.OT_hour > 0) {
                        otChange = ((row.OT_hour - prevRow.OT_hour) / prevRow.OT_hour) * 100;
                    }
                    if (prevRow.total_labor_cost > 0) {
                        costChange = ((row.total_labor_cost - prevRow.total_labor_cost) / prevRow.total_labor_cost) * 100;
                    }
                }
                
                var otColor = otChange > 0 ? '#e74c3c' : (otChange < 0 ? '#27ae60' : '#333');
                var otSign = otChange > 0 ? '+' : '';
                var otText = i > 0 ? otSign + otChange.toFixed(2) + '%' : '-';
                
                var costColor = costChange > 0 ? '#e74c3c' : (costChange < 0 ? '#27ae60' : '#333');
                var costSign = costChange > 0 ? '+' : '';
                var costText = i > 0 ? costSign + costChange.toFixed(2) + '%' : '-';
                
                var tr = document.createElement('tr');
                tr.setAttribute('data-period', row.Period);
                tr.innerHTML = `
                    <td>${row.Period}</td>
                    <td>$${(row.net_sales || 0).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td>$${(row.total_labor_cost || 0).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td>${(row.labor_cost_pct || 0).toFixed(2)}%</td>
                    <td>$${(row.sales_per_labor_hour || 0).toFixed(2)}</td>
                    <td>${(row.total_Labor_hour || 0).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td>${(row.OT_hour || 0).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td>${(row.overtime_pct || 0).toFixed(2)}%</td>
                    <td>${(row.HC || 0).toFixed(0)}</td>
                    <td style="color: ${otColor}; font-weight: bold;">${otText}</td>
                    <td style="color: ${costColor}; font-weight: bold;">${costText}</td>
                `;
                tbody.appendChild(tr);
            }
        }
        
        function updateMonthlySummary(data) {
            if (data.length === 0) return;
            
            // Group by month
            var monthlyData = {};
            data.forEach(function(item) {
                var month = item.start_date.substring(0, 7); // YYYY-MM
                if (!monthlyData[month]) {
                    monthlyData[month] = {
                        net_sales: 0,
                        total_labor_cost: 0,
                        total_Labor_hour: 0,
                        OT_hour: 0,
                        HC: []
                    };
                }
                monthlyData[month].net_sales += item.net_sales || 0;
                monthlyData[month].total_labor_cost += item.total_labor_cost || 0;
                monthlyData[month].total_Labor_hour += item.total_Labor_hour || 0;
                monthlyData[month].OT_hour += item.OT_hour || 0;
                if (item.HC) monthlyData[month].HC.push(item.HC);
            });
            
            var tbody = document.getElementById('monthlyTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            var months = Object.keys(monthlyData).sort();
            months.forEach(function(month) {
                var monthData = monthlyData[month];
                var laborCostPct = monthData.net_sales > 0 ? (monthData.total_labor_cost / monthData.net_sales * 100) : 0;
                var splh = monthData.total_Labor_hour > 0 ? (monthData.net_sales / monthData.total_Labor_hour) : 0;
                var avgHC = monthData.HC.length > 0 ? (monthData.HC.reduce((a, b) => a + b, 0) / monthData.HC.length) : 0;
                
                var monthDisplay = month.replace(/-/, '年').replace(/-/, '月') + '月';
                
                var tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${monthDisplay}</td>
                    <td>$${monthData.net_sales.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td>$${monthData.total_labor_cost.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td>${laborCostPct.toFixed(2)}%</td>
                    <td>$${splh.toFixed(2)}</td>
                    <td>${monthData.total_Labor_hour.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td>${monthData.OT_hour.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td>${avgHC.toFixed(1)}</td>
                `;
                tbody.appendChild(tr);
            });
        }
        
        function updateInsights(data) {
            if (data.length === 0) return;
            
            var laborCostPcts = data.map(item => item.labor_cost_pct || 0);
            var bestIdx = laborCostPcts.indexOf(Math.min(...laborCostPcts));
            var worstIdx = laborCostPcts.indexOf(Math.max(...laborCostPcts));
            var bestPeriod = data[bestIdx];
            var worstPeriod = data[worstIdx];
            
            var netSales = data.map(item => item.net_sales || 0);
            var laborCosts = data.map(item => item.total_labor_cost || 0);
            var correlation = calculateCorrelation(netSales, laborCosts);
            
            var firstHalf = data.slice(0, Math.floor(data.length / 2));
            var secondHalf = data.slice(Math.floor(data.length / 2));
            var firstHalfAvg = firstHalf.reduce((sum, item) => sum + (item.labor_cost_pct || 0), 0) / firstHalf.length;
            var secondHalfAvg = secondHalf.reduce((sum, item) => sum + (item.labor_cost_pct || 0), 0) / secondHalf.length;
            var trend = secondHalfAvg < firstHalfAvg ? '改善' : '下降';
            
            var avgOvertimePct = data.reduce((sum, item) => sum + (item.overtime_pct || 0), 0) / data.length;
            
            // Update insights section
            var bestPeriodEl = document.getElementById('bestPeriod');
            var worstPeriodEl = document.getElementById('worstPeriod');
            var correlationEl = document.getElementById('correlation');
            var trendEl = document.getElementById('trend');
            var overtimeEl = document.getElementById('overtime');
            
            if (bestPeriodEl && bestPeriod) {
                bestPeriodEl.innerHTML = `
                    <h3>1. 最佳表现时间段：${bestPeriod.Period}</h3>
                    <ul>
                        <li>人工成本占比：${bestPeriod.labor_cost_pct.toFixed(2)}%</li>
                        <li>每小时销售额：$${bestPeriod.sales_per_labor_hour.toFixed(2)}</li>
                        <li>关键因素：员工数量 ${bestPeriod.HC.toFixed(0)} 人，加班占比 ${bestPeriod.overtime_pct.toFixed(2)}%</li>
                    </ul>
                `;
            }
            
            if (worstPeriodEl && worstPeriod) {
                worstPeriodEl.innerHTML = `
                    <h3>2. 最差表现时间段：${worstPeriod.Period}</h3>
                    <ul>
                        <li>人工成本占比：${worstPeriod.labor_cost_pct.toFixed(2)}%</li>
                        <li>每小时销售额：$${worstPeriod.sales_per_labor_hour.toFixed(2)}</li>
                        <li>关键因素：员工数量 ${worstPeriod.HC.toFixed(0)} 人，加班占比 ${worstPeriod.overtime_pct.toFixed(2)}%</li>
                    </ul>
                `;
            }
            
            if (correlationEl) {
                var correlationText = correlation > 0.7 ? '强正相关 - 人工成本与销售额呈良好比例关系' :
                                     correlation > 0.4 ? '中等正相关 - 人工成本与销售额有一定关联' :
                                     '弱相关 - 存在显著效率提升空间';
                correlationEl.innerHTML = `
                    <h3>3. 销售额-人工成本相关性：${correlation.toFixed(3)}</h3>
                    <p>${correlationText}</p>
                `;
            }
            
            if (trendEl) {
                trendEl.innerHTML = `
                    <h3>5. 趋势分析：人工效率${trend}</h3>
                    <p>前半段平均：${firstHalfAvg.toFixed(2)}%</p>
                    <p>后半段平均：${secondHalfAvg.toFixed(2)}%</p>
                `;
            }
            
            if (overtimeEl) {
                var overtimeText = avgOvertimePct > 20 ? 
                    '平均加班工时占比为 ' + avgOvertimePct.toFixed(2) + '%，建议：审查排班以减少加班成本' :
                    '平均加班工时占比为 ' + avgOvertimePct.toFixed(2) + '% - 在可接受范围内';
                overtimeEl.innerHTML = `
                    <h3>4. 加班工时状态</h3>
                    <p>${overtimeText}</p>
                `;
            }
        }
        
        function calculateCorrelation(x, y) {
            var n = x.length;
            var sumX = x.reduce((a, b) => a + b, 0);
            var sumY = y.reduce((a, b) => a + b, 0);
            var sumXY = x.reduce((sum, xi, i) => sum + xi * y[i], 0);
            var sumX2 = x.reduce((sum, xi) => sum + xi * xi, 0);
            var sumY2 = y.reduce((sum, yi) => sum + yi * yi, 0);
            
            var numerator = n * sumXY - sumX * sumY;
            var denominator = Math.sqrt((n * sumX2 - sumX * sumX) * (n * sumY2 - sumY * sumY));
            
            return denominator === 0 ? 0 : numerator / denominator;
        }
        
        function updateCharts(data) {
            // Check if Chart.js is loaded
            if (typeof Chart === 'undefined') {
                console.error('Chart.js is not loaded');
                return;
            }
            
            // Get filtered data or use all data
            var chartData = data || allData;
            if (!chartData || chartData.length === 0) {
                console.warn('No chart data available');
                return;
            }
            
            // Sort data by start_date
            var sortedData = chartData.slice().sort((a, b) => new Date(a.start_date) - new Date(b.start_date));
            var periodLabels = sortedData.map(item => item.Period);
            
            // Update charts for each tab
            updateTotalChart(sortedData, periodLabels);
            updateLaborCostChart(sortedData, periodLabels);
            updateSplhChart(sortedData, periodLabels);
            updateOvertimeChart(sortedData, periodLabels);
        }
        
        function updateTotalChart(data, labels) {
            var ctx = document.getElementById('totalChart');
            if (!ctx) return;
            
            if (chartInstances['total']) {
                chartInstances['total'].destroy();
            }
            
            chartInstances['total'] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'net_sales',
                            data: data.map(item => item.net_sales || 0),
                            backgroundColor: 'rgba(155, 89, 182, 0.7)',
                            yAxisID: 'y'
                        },
                        {
                            label: 'labor_cost',
                            data: data.map(item => item.total_labor_cost || 0),
                            backgroundColor: 'rgba(255, 165, 0, 0.7)',
                            yAxisID: 'y'
                        },
                        {
                            label: 'labor_cost/net_sales',
                            data: data.map(item => item.labor_cost_pct || 0),
                            type: 'line',
                            borderColor: 'rgb(231, 76, 60)',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            yAxisID: 'y1',
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Bi-Weekly Labor Report',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    var label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.datasetIndex < 2) {
                                        label += '$' + context.parsed.y.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                    } else {
                                        label += context.parsed.y.toFixed(2) + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'labor_cost | net_sales ($)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'labor_cost/net_sales (%)'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    }
                }
            });
        }
        
        function updateLaborCostChart(data, labels) {
            var ctx = document.getElementById('laborCostChart');
            if (!ctx) return;
            
            if (chartInstances['labor_cost']) {
                chartInstances['labor_cost'].destroy();
            }
            
            chartInstances['labor_cost'] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'labor_cost/net_sales',
                            data: data.map(item => item.labor_cost_pct || 0),
                            backgroundColor: 'rgba(52, 152, 219, 0.7)',
                            yAxisID: 'y'
                        },
                        {
                            label: 'labor_cost',
                            data: data.map(item => item.total_labor_cost || 0),
                            backgroundColor: 'rgba(255, 215, 0, 0.7)',
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'labor_cost/net_sales and labor_cost by Period',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    var label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.datasetIndex === 0) {
                                        label += context.parsed.y.toFixed(2) + '%';
                                    } else {
                                        label += '$' + context.parsed.y.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'labor_cost/net_sales (%)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'labor_cost ($)'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    }
                }
            });
        }
        
        function updateSplhChart(data, labels) {
            var ctx = document.getElementById('splhChart');
            if (!ctx) return;
            
            if (chartInstances['splh']) {
                chartInstances['splh'].destroy();
            }
            
            chartInstances['splh'] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'SPLH',
                            data: data.map(item => item.sales_per_labor_hour || 0),
                            backgroundColor: 'rgba(52, 152, 219, 0.7)',
                            yAxisID: 'y'
                        },
                        {
                            label: 'net_sales',
                            data: data.map(item => item.net_sales || 0),
                            backgroundColor: 'rgba(255, 165, 0, 0.7)',
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'SPLH and net_sales by Period',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    var label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.datasetIndex === 0) {
                                        label += '$' + context.parsed.y.toFixed(2);
                                    } else {
                                        label += '$' + context.parsed.y.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'SPLH ($)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'net_sales ($)'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    }
                }
            });
        }
        
        function updateOvertimeChart(data, labels) {
            var ctx = document.getElementById('overtimeChart');
            if (!ctx) return;
            
            if (chartInstances['overtime']) {
                chartInstances['overtime'].destroy();
            }
            
            // Calculate percentages
            var otPcts = data.map(item => {
                var total = item.total_Labor_hour || 0;
                var ot = item.OT_hour || 0;
                return total > 0 ? (ot / total * 100) : 0;
            });
            var regularPcts = data.map(item => {
                var total = item.total_Labor_hour || 0;
                var ot = item.OT_hour || 0;
                return total > 0 ? ((total - ot) / total * 100) : 0;
            });
            
            chartInstances['overtime'] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'total_Labor_hour',
                            data: regularPcts,
                            backgroundColor: 'rgba(46, 204, 113, 0.7)',
                            stack: 'stack1'
                        },
                        {
                            label: 'OT_hour',
                            data: otPcts,
                            backgroundColor: 'rgba(255, 215, 0, 0.7)',
                            stack: 'stack1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'OT_hour and total_Labor_hour by Period',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    var label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += context.parsed.y.toFixed(2) + '%';
                                    return label;
                                },
                                afterBody: function(context) {
                                    var index = context[0].dataIndex;
                                    var item = data[index];
                                    return [
                                        'OT: ' + (item.OT_hour || 0).toFixed(0) + 'h',
                                        'Total: ' + (item.total_Labor_hour || 0).toFixed(0) + 'h'
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        },
                        y: {
                            stacked: true,
                            max: 100,
                            title: {
                                display: true,
                                text: '百分比 (%)'
                            }
                        }
                    }
                }
            });
        }
    </script>
</head>
<body>
    <div class="header">
        <h1>LV门店人工效率分析报告</h1>
        <div style="margin-top: 20px; display: flex; align-items: center; justify-content: center; gap: 15px; flex-wrap: wrap;">
            <label for="startDate" style="font-size: 1.1em;">分析期间：</label>
            <select id="startDate" style="padding: 8px 15px; font-size: 1em; border: 2px solid rgba(255,255,255,0.5); border-radius: 5px; background: rgba(255,255,255,0.2); color: white; cursor: pointer;">
                <option value="">选择开始日期</option>
                <option value="2024-12-30">2024年12月30日</option>
                <option value="2025-01-13">2025年01月13日</option>
                <option value="2025-01-27">2025年01月27日</option>
                <option value="2025-02-10">2025年02月10日</option>
                <option value="2025-02-24">2025年02月24日</option>
                <option value="2025-03-10">2025年03月10日</option>
                <option value="2025-03-24">2025年03月24日</option>
                <option value="2025-04-07">2025年04月07日</option>
                <option value="2025-04-21">2025年04月21日</option>
                <option value="2025-05-05">2025年05月05日</option>
                <option value="2025-05-19">2025年05月19日</option>
                <option value="2025-06-02">2025年06月02日</option>
                <option value="2025-06-16">2025年06月16日</option>
                <option value="2025-06-30">2025年06月30日</option>
                <option value="2025-07-14">2025年07月14日</option>
                <option value="2025-07-28">2025年07月28日</option>
                <option value="2025-08-11">2025年08月11日</option>
                <option value="2025-08-25">2025年08月25日</option>
                <option value="2025-09-08">2025年09月08日</option>
                <option value="2025-09-22">2025年09月22日</option>
                <option value="2025-10-06">2025年10月06日</option>
                <option value="2025-10-20">2025年10月20日</option>
                <option value="2025-11-03">2025年11月03日</option>
                <option value="2025-11-17">2025年11月17日</option>
            </select>
            <span style="font-size: 1.1em;">至</span>
            <select id="endDate" style="padding: 8px 15px; font-size: 1em; border: 2px solid rgba(255,255,255,0.5); border-radius: 5px; background: rgba(255,255,255,0.2); color: white; cursor: pointer;">
                <option value="">选择结束日期</option>
                <option value="2024-12-30">2024年12月30日</option>
                <option value="2025-01-13">2025年01月13日</option>
                <option value="2025-01-27">2025年01月27日</option>
                <option value="2025-02-10">2025年02月10日</option>
                <option value="2025-02-24">2025年02月24日</option>
                <option value="2025-03-10">2025年03月10日</option>
                <option value="2025-03-24">2025年03月24日</option>
                <option value="2025-04-07">2025年04月07日</option>
                <option value="2025-04-21">2025年04月21日</option>
                <option value="2025-05-05">2025年05月05日</option>
                <option value="2025-05-19">2025年05月19日</option>
                <option value="2025-06-02">2025年06月02日</option>
                <option value="2025-06-16">2025年06月16日</option>
                <option value="2025-06-30">2025年06月30日</option>
                <option value="2025-07-14">2025年07月14日</option>
                <option value="2025-07-28">2025年07月28日</option>
                <option value="2025-08-11">2025年08月11日</option>
                <option value="2025-08-25">2025年08月25日</option>
                <option value="2025-09-08">2025年09月08日</option>
                <option value="2025-09-22">2025年09月22日</option>
                <option value="2025-10-06">2025年10月06日</option>
                <option value="2025-10-20">2025年10月20日</option>
                <option value="2025-11-03">2025年11月03日</option>
                <option value="2025-11-17">2025年11月17日</option>
            </select>
            <button id="confirmDateBtn" onclick="updateDateRange()" class="confirm-btn" style="margin-left: 10px;">确认</button>
            <span id="dateRangeDisplay" style="font-size: 1.1em; margin-left: 10px;">2024年12月30日 - 2025年11月17日</span>
        </div>
        <p>报告生成时间：2026年01月12日</p>
    </div>
    
    <!-- Embed all data as JSON for JavaScript filtering -->
    <script type="application/json" id="allData">
[
  {
    "Period": "12/30-1/12",
    "Tips": 7341.59,
    "lv_net_sales": 86084.65,
    "lv_totalLaborcost": 31816.43,
    "Tips_Distributed": 9177.0,
    "if_match": 1835.41,
    "LV_LaborCost_no_tips": 22639.43,
    "labor_cost/net_sales": 0.263,
    "total_Labor_hour": 1099.82,
    "OT_hour": 194.33,
    "SPLH": 78.27,
    "HC": 20.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": 1136.81,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 1136.81,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 23776.24,
    "TotalLaborCost/NetSales": 0.2761960466,
    "Unnamed: 22": null,
    "Unnamed: 23": "LV（Las Vegas）",
    "start_date": "2024-12-30T00:00:00",
    "end_date": "2025-01-12T00:00:00",
    "net_sales": 86084.65,
    "MP_LaborCost": 22639.43,
    "MP_TotalLaborCostExcludingTips": 23776.24,
    "total_labor_cost": 23776.24,
    "labor_cost_pct": 27.619604656579313,
    "sales_per_labor_hour": 78.27158080413159,
    "labor_cost_per_hour": 21.618301176556166,
    "overtime_pct": 17.66925496899493,
    "period_midpoint": "2025-01-05T12:00:00"
  },
  {
    "Period": "1/13-1/26",
    "Tips": 7433.74,
    "lv_net_sales": 88065.24,
    "lv_totalLaborcost": 35461.02,
    "Tips_Distributed": 9156.0,
    "if_match": 1722.26,
    "LV_LaborCost_no_tips": 26305.02,
    "labor_cost/net_sales": 0.2987,
    "total_Labor_hour": 1264.31,
    "OT_hour": 261.59,
    "SPLH": 69.65,
    "HC": 21.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": null,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 0.0,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 26305.02,
    "TotalLaborCost/NetSales": 0.2986992371,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-01-13T00:00:00",
    "end_date": "2025-01-26T00:00:00",
    "net_sales": 88065.24,
    "MP_LaborCost": 26305.02,
    "MP_TotalLaborCostExcludingTips": 26305.02,
    "total_labor_cost": 26305.02,
    "labor_cost_pct": 29.86992370656118,
    "sales_per_labor_hour": 69.65478403239713,
    "labor_cost_per_hour": 20.80583084844698,
    "overtime_pct": 20.69033702177472,
    "period_midpoint": "2025-01-19T12:00:00"
  },
  {
    "Period": "1/27-2/9",
    "Tips": 6587.99,
    "lv_net_sales": 73634.73,
    "lv_totalLaborcost": 31417.51,
    "Tips_Distributed": 8279.64,
    "if_match": 1691.65,
    "LV_LaborCost_no_tips": 23137.87,
    "labor_cost/net_sales": 0.3142,
    "total_Labor_hour": 1156.46,
    "OT_hour": 201.47,
    "SPLH": 63.67,
    "HC": 21.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": 1671.315,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 1671.315,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 24809.185,
    "TotalLaborCost/NetSales": 0.3369223327,
    "Unnamed: 22": null,
    "Unnamed: 23": "Labor Cost 平均近 28%，波动剧烈（20.53%–45.28%）",
    "start_date": "2025-01-27T00:00:00",
    "end_date": "2025-02-09T00:00:00",
    "net_sales": 73634.73,
    "MP_LaborCost": 23137.87,
    "MP_TotalLaborCostExcludingTips": 24809.185,
    "total_labor_cost": 24809.185,
    "labor_cost_pct": 33.69223327090356,
    "sales_per_labor_hour": 63.672526503294534,
    "labor_cost_per_hour": 21.452696158967886,
    "overtime_pct": 17.42126835342338,
    "period_midpoint": "2025-02-02T12:00:00"
  },
  {
    "Period": "2/10-2/23",
    "Tips": 8458.36,
    "lv_net_sales": 96843.33,
    "lv_totalLaborcost": 41290.84,
    "Tips_Distributed": 10284.89,
    "if_match": 1826.53,
    "LV_LaborCost_no_tips": 31005.95,
    "labor_cost/net_sales": 0.3202,
    "total_Labor_hour": 1175.45,
    "OT_hour": 230.58,
    "SPLH": 82.39,
    "HC": 17.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": 1671.315,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 1671.315,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 32677.265,
    "TotalLaborCost/NetSales": 0.3374240126,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-02-10T00:00:00",
    "end_date": "2025-02-23T00:00:00",
    "net_sales": 96843.33,
    "MP_LaborCost": 31005.95,
    "MP_TotalLaborCostExcludingTips": 32677.265,
    "total_labor_cost": 32677.265,
    "labor_cost_pct": 33.742401257784095,
    "sales_per_labor_hour": 82.38830235229061,
    "labor_cost_per_hour": 27.79979156918627,
    "overtime_pct": 19.616317155132077,
    "period_midpoint": "2025-02-16T12:00:00"
  },
  {
    "Period": "2/24-3/9",
    "Tips": 9906.9,
    "lv_net_sales": 118021.94,
    "lv_totalLaborcost": 35942.05,
    "Tips_Distributed": 11716.0,
    "if_match": 1809.1,
    "LV_LaborCost_no_tips": 24226.05,
    "labor_cost/net_sales": 0.2053,
    "total_Labor_hour": 1143.72,
    "OT_hour": 222.58,
    "SPLH": 103.19,
    "HC": 15.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": null,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 0.0,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 24226.05,
    "TotalLaborCost/NetSales": 0.2052673427,
    "Unnamed: 22": null,
    "Unnamed: 23": "SPLH 长期低于 $70",
    "start_date": "2025-02-24T00:00:00",
    "end_date": "2025-03-09T00:00:00",
    "net_sales": 118021.94,
    "MP_LaborCost": 24226.05,
    "MP_TotalLaborCostExcludingTips": 24226.05,
    "total_labor_cost": 24226.05,
    "labor_cost_pct": 20.526734266527054,
    "sales_per_labor_hour": 103.19128807750148,
    "labor_cost_per_hour": 21.18180148987514,
    "overtime_pct": 19.461056902038962,
    "period_midpoint": "2025-03-02T12:00:00"
  },
  {
    "Period": "3/10-3/23",
    "Tips": 10859.45,
    "lv_net_sales": 129865.81,
    "lv_totalLaborcost": 42185.71,
    "Tips_Distributed": 12327.42,
    "if_match": 1467.97,
    "LV_LaborCost_no_tips": 29858.29,
    "labor_cost/net_sales": 0.2299,
    "total_Labor_hour": 1411.67,
    "OT_hour": 374.9,
    "SPLH": 91.99,
    "HC": 17.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": 398.52,
    "Payroll_NewHire": 4598.32,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 398.52,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 30256.81,
    "TotalLaborCost/NetSales": 0.2329851868,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-03-10T00:00:00",
    "end_date": "2025-03-23T00:00:00",
    "net_sales": 129865.81,
    "MP_LaborCost": 29858.29,
    "MP_TotalLaborCostExcludingTips": 30256.81,
    "total_labor_cost": 30256.81,
    "labor_cost_pct": 23.29851867862681,
    "sales_per_labor_hour": 91.9944533779141,
    "labor_cost_per_hour": 21.433344903553948,
    "overtime_pct": 26.557198212046725,
    "period_midpoint": "2025-03-16T12:00:00"
  },
  {
    "Period": "3/24-4/6",
    "Tips": 9072.8,
    "lv_net_sales": 108307.51,
    "lv_totalLaborcost": 35519.53,
    "Tips_Distributed": 10170.0,
    "if_match": 1097.2,
    "LV_LaborCost_no_tips": 25349.53,
    "labor_cost/net_sales": 0.2341,
    "total_Labor_hour": 1246.04,
    "OT_hour": 256.39,
    "SPLH": 86.92,
    "HC": 19.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": 3852.33,
    "Payroll_NewHire": 1700.12,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 3852.33,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 29201.86,
    "TotalLaborCost/NetSales": 0.2696198999,
    "Unnamed: 22": null,
    "Unnamed: 23": "问题判断：",
    "start_date": "2025-03-24T00:00:00",
    "end_date": "2025-04-06T00:00:00",
    "net_sales": 108307.51,
    "MP_LaborCost": 25349.53,
    "MP_TotalLaborCostExcludingTips": 29201.86,
    "total_labor_cost": 29201.86,
    "labor_cost_pct": 26.961989985735986,
    "sales_per_labor_hour": 86.92137491573304,
    "labor_cost_per_hour": 23.435732400243975,
    "overtime_pct": 20.576385990818913,
    "period_midpoint": "2025-03-30T12:00:00"
  },
  {
    "Period": "4/7-4/20",
    "Tips": 6181.87,
    "lv_net_sales": 74457.25,
    "lv_totalLaborcost": 41216.64,
    "Tips_Distributed": 7502.0,
    "if_match": 1320.13,
    "LV_LaborCost_no_tips": 33714.64,
    "labor_cost/net_sales": 0.4528,
    "total_Labor_hour": 1273.0,
    "OT_hour": 235.5,
    "SPLH": 58.49,
    "HC": 17.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": null,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 0.0,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 33714.64,
    "TotalLaborCost/NetSales": 0.4528053346,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-04-07T00:00:00",
    "end_date": "2025-04-20T00:00:00",
    "net_sales": 74457.25,
    "MP_LaborCost": 33714.64,
    "MP_TotalLaborCostExcludingTips": 33714.64,
    "total_labor_cost": 33714.64,
    "labor_cost_pct": 45.28053346047564,
    "sales_per_labor_hour": 58.489591516103694,
    "labor_cost_per_hour": 26.484399057344856,
    "overtime_pct": 18.49960722702278,
    "period_midpoint": "2025-04-13T12:00:00"
  },
  {
    "Period": "4/21-5/4",
    "Tips": 7299.56,
    "lv_net_sales": 91729.06,
    "lv_totalLaborcost": 29951.73,
    "Tips_Distributed": 8254.37,
    "if_match": 954.81,
    "LV_LaborCost_no_tips": 21697.36,
    "labor_cost/net_sales": 0.2365,
    "total_Labor_hour": 1063.5,
    "OT_hour": 200.0,
    "SPLH": 86.25,
    "HC": 16.0,
    "Payroll_Dismissal": 1992.6,
    "Payroll_OffCycle": 3466.22,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 5458.82,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 27156.18,
    "TotalLaborCost/NetSales": 0.2960477301,
    "Unnamed: 22": null,
    "Unnamed: 23": "Overtime 使用较多（每期超 150 小时）；",
    "start_date": "2025-04-21T00:00:00",
    "end_date": "2025-05-04T00:00:00",
    "net_sales": 91729.06,
    "MP_LaborCost": 21697.36,
    "MP_TotalLaborCostExcludingTips": 27156.18,
    "total_labor_cost": 27156.18,
    "labor_cost_pct": 29.60477301304516,
    "sales_per_labor_hour": 86.25205453690644,
    "labor_cost_per_hour": 25.53472496473907,
    "overtime_pct": 18.805829807240247,
    "period_midpoint": "2025-04-27T12:00:00"
  },
  {
    "Period": "5/5-5/18",
    "Tips": 7324.48,
    "lv_net_sales": 87248.43,
    "lv_totalLaborcost": 30113.99,
    "Tips_Distributed": 8286.35,
    "if_match": 961.87,
    "LV_LaborCost_no_tips": 21827.64,
    "labor_cost/net_sales": 0.2502,
    "total_Labor_hour": 1155.5,
    "OT_hour": 202.0,
    "SPLH": 75.51,
    "HC": 17.0,
    "Payroll_Dismissal": 1361.62,
    "Payroll_OffCycle": 3065.54,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 4427.16,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 26254.8,
    "TotalLaborCost/NetSales": 0.300920028,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-05-05T00:00:00",
    "end_date": "2025-05-18T00:00:00",
    "net_sales": 87248.43,
    "MP_LaborCost": 21827.64,
    "MP_TotalLaborCostExcludingTips": 26254.8,
    "total_labor_cost": 26254.8,
    "labor_cost_pct": 30.092002801655,
    "sales_per_labor_hour": 75.50707918649934,
    "labor_cost_per_hour": 22.72159238424924,
    "overtime_pct": 17.48160969277369,
    "period_midpoint": "2025-05-11T12:00:00"
  },
  {
    "Period": "5/19-6/1",
    "Tips": 6141.52,
    "lv_net_sales": 74619.19,
    "lv_totalLaborcost": 28804.48,
    "Tips_Distributed": 7210.39,
    "if_match": 1068.87,
    "LV_LaborCost_no_tips": 21594.09,
    "labor_cost/net_sales": 0.2894,
    "total_Labor_hour": 1153.41,
    "OT_hour": 189.8,
    "SPLH": 64.69,
    "HC": 17.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": 3065.53,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 3065.53,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 24659.62,
    "TotalLaborCost/NetSales": 0.3304728985,
    "Unnamed: 22": null,
    "Unnamed: 23": "可能存在销售不稳定与人员冗余双重影响。",
    "start_date": "2025-05-19T00:00:00",
    "end_date": "2025-06-01T00:00:00",
    "net_sales": 74619.19,
    "MP_LaborCost": 21594.09,
    "MP_TotalLaborCostExcludingTips": 24659.62,
    "total_labor_cost": 24659.62,
    "labor_cost_pct": 33.04728984594981,
    "sales_per_labor_hour": 64.69441915710806,
    "labor_cost_per_hour": 21.37975221300318,
    "overtime_pct": 16.455553532568644,
    "period_midpoint": "2025-05-25T12:00:00"
  },
  {
    "Period": "6/2-6/15",
    "Tips": 5486.06,
    "lv_net_sales": 65239.25,
    "lv_totalLaborcost": 28332.63,
    "Tips_Distributed": 6698.59,
    "if_match": 1212.53,
    "LV_LaborCost_no_tips": 21634.04,
    "labor_cost/net_sales": 0.3316,
    "total_Labor_hour": 1083.4,
    "OT_hour": 156.34,
    "SPLH": 60.22,
    "HC": 17.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": 3065.53,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 3065.53,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 24699.57,
    "TotalLaborCost/NetSales": 0.378599846,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-06-02T00:00:00",
    "end_date": "2025-06-15T00:00:00",
    "net_sales": 65239.25,
    "MP_LaborCost": 21634.04,
    "MP_TotalLaborCostExcludingTips": 24699.57,
    "total_labor_cost": 24699.57,
    "labor_cost_pct": 37.85998459516319,
    "sales_per_labor_hour": 60.21714048366254,
    "labor_cost_per_hour": 22.798200110762412,
    "overtime_pct": 14.430496584825548,
    "period_midpoint": "2025-06-08T12:00:00"
  },
  {
    "Period": "6/16-6/29",
    "Tips": 5054.36,
    "lv_net_sales": 60471.08,
    "lv_totalLaborcost": 21807.87,
    "Tips_Distributed": 5919.2,
    "if_match": 864.84,
    "LV_LaborCost_no_tips": 15888.67,
    "labor_cost/net_sales": 0.2627,
    "total_Labor_hour": 1171.05,
    "OT_hour": 151.45,
    "SPLH": 51.64,
    "HC": 17.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": 1348.86,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 1348.86,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 17237.53,
    "TotalLaborCost/NetSales": 0.2850541118,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-06-16T00:00:00",
    "end_date": "2025-06-29T00:00:00",
    "net_sales": 60471.08,
    "MP_LaborCost": 15888.67,
    "MP_TotalLaborCostExcludingTips": 17237.53,
    "total_labor_cost": 17237.53,
    "labor_cost_pct": 28.505411181675598,
    "sales_per_labor_hour": 51.638341659194744,
    "labor_cost_per_hour": 14.719721617351949,
    "overtime_pct": 12.932838051321463,
    "period_midpoint": "2025-06-22T12:00:00"
  },
  {
    "Period": "6/30-7/13",
    "Tips": 5083.07,
    "lv_net_sales": 63599.0,
    "lv_totalLaborcost": 20239.5,
    "Tips_Distributed": 5932.52,
    "if_match": 849.45,
    "LV_LaborCost_no_tips": 14306.98,
    "labor_cost/net_sales": 0.225,
    "total_Labor_hour": 1103.86,
    "OT_hour": 182.63,
    "SPLH": 57.62,
    "HC": 16.0,
    "Payroll_Dismissal": 902.01,
    "Payroll_OffCycle": 1827.64,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 2729.65,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 17036.63,
    "TotalLaborCost/NetSales": 0.2678757528,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-06-30T00:00:00",
    "end_date": "2025-07-13T00:00:00",
    "net_sales": 63599.0,
    "MP_LaborCost": 14306.98,
    "MP_TotalLaborCostExcludingTips": 17036.63,
    "total_labor_cost": 17036.63,
    "labor_cost_pct": 26.787575276340824,
    "sales_per_labor_hour": 57.61509611726125,
    "labor_cost_per_hour": 15.433687242947478,
    "overtime_pct": 16.544670519812296,
    "period_midpoint": "2025-07-06T12:00:00"
  },
  {
    "Period": "7/14-7/27",
    "Tips": 5769.6,
    "lv_net_sales": 57546.81,
    "lv_totalLaborcost": 22464.03,
    "Tips_Distributed": 5694.37,
    "if_match": -75.23,
    "LV_LaborCost_no_tips": 16769.66,
    "labor_cost/net_sales": 0.2914090286,
    "total_Labor_hour": 1173.5,
    "OT_hour": 123.0,
    "SPLH": 49.03861099,
    "HC": 19.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": 1679.72,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 1679.72,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 18449.38,
    "TotalLaborCost/NetSales": 0.3205977881,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-07-14T00:00:00",
    "end_date": "2025-07-27T00:00:00",
    "net_sales": 57546.81,
    "MP_LaborCost": 16769.66,
    "MP_TotalLaborCostExcludingTips": 18449.38,
    "total_labor_cost": 18449.38,
    "labor_cost_pct": 32.05977881310885,
    "sales_per_labor_hour": 49.03861099275671,
    "labor_cost_per_hour": 15.72167021729868,
    "overtime_pct": 10.48146570089476,
    "period_midpoint": "2025-07-20T12:00:00"
  },
  {
    "Period": "7/28-8/10",
    "Tips": 4321.6,
    "lv_net_sales": 52089.5,
    "lv_totalLaborcost": 21266.89,
    "Tips_Distributed": 5018.08,
    "if_match": 696.48,
    "LV_LaborCost_no_tips": 16248.81,
    "labor_cost/net_sales": 0.3119402183,
    "total_Labor_hour": 1143.6,
    "OT_hour": 134.8,
    "SPLH": 45.54870584,
    "HC": 18.0,
    "Payroll_Dismissal": 710.09,
    "Payroll_OffCycle": 2560.36,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 3270.45,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 19519.26,
    "TotalLaborCost/NetSales": 0.3747254245,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-07-28T00:00:00",
    "end_date": "2025-08-10T00:00:00",
    "net_sales": 52089.5,
    "MP_LaborCost": 16248.81,
    "MP_TotalLaborCostExcludingTips": 19519.26,
    "total_labor_cost": 19519.26,
    "labor_cost_pct": 37.4725424509738,
    "sales_per_labor_hour": 45.54870584120322,
    "labor_cost_per_hour": 17.068258132214062,
    "overtime_pct": 11.787338230150404,
    "period_midpoint": "2025-08-03T12:00:00"
  },
  {
    "Period": "8/11-8/24",
    "Tips": 3776.58,
    "lv_net_sales": 44574.39,
    "lv_totalLaborcost": 21208.08,
    "Tips_Distributed": 4657.5,
    "if_match": 880.92,
    "LV_LaborCost_no_tips": 16550.58,
    "labor_cost/net_sales": 0.3713024452,
    "total_Labor_hour": 1179.0,
    "OT_hour": 124.0,
    "SPLH": 37.80694656,
    "HC": 19.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": 6753.77,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 6753.77,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 23304.35,
    "TotalLaborCost/NetSales": 0.5228192691,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-08-11T00:00:00",
    "end_date": "2025-08-24T00:00:00",
    "net_sales": 44574.39,
    "MP_LaborCost": 16550.58,
    "MP_TotalLaborCostExcludingTips": 23304.35,
    "total_labor_cost": 23304.35,
    "labor_cost_pct": 52.28192690915119,
    "sales_per_labor_hour": 37.80694656488549,
    "labor_cost_per_hour": 19.766200169635283,
    "overtime_pct": 10.517387616624257,
    "period_midpoint": "2025-08-17T12:00:00"
  },
  {
    "Period": "8/25-9/7",
    "Tips": 5155.35,
    "lv_net_sales": 53570.94,
    "lv_totalLaborcost": 22346.58,
    "Tips_Distributed": 5695.0,
    "if_match": 539.65,
    "LV_LaborCost_no_tips": 16651.58,
    "labor_cost/net_sales": 0.3108323281,
    "total_Labor_hour": 1145.0,
    "OT_hour": 118.5,
    "SPLH": 46.78684716,
    "HC": 15.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": null,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 0.0,
    "Other": null,
    "NV_TotalLaborCostExcludingTips": 16651.58,
    "TotalLaborCost/NetSales": 0.3108323281,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-08-25T00:00:00",
    "end_date": "2025-09-07T00:00:00",
    "net_sales": 53570.94,
    "MP_LaborCost": 16651.58,
    "MP_TotalLaborCostExcludingTips": 16651.58,
    "total_labor_cost": 16651.58,
    "labor_cost_pct": 31.083232812416583,
    "sales_per_labor_hour": 46.786847161572055,
    "labor_cost_per_hour": 14.542864628820963,
    "overtime_pct": 10.34934497816594,
    "period_midpoint": "2025-08-31T12:00:00"
  },
  {
    "Period": "9/8-9/21",
    "Tips": 5472.01,
    "lv_net_sales": 54031.52,
    "lv_totalLaborcost": 20850.1,
    "Tips_Distributed": 5688.38,
    "if_match": 216.37,
    "LV_LaborCost_no_tips": 15161.72,
    "labor_cost/net_sales": 0.2806088002,
    "total_Labor_hour": 1073.7,
    "OT_hour": 71.9,
    "SPLH": 50.32273447,
    "HC": 15.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": null,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 0.0,
    "Other": -3300.0,
    "NV_TotalLaborCostExcludingTips": 11861.72,
    "TotalLaborCost/NetSales": 0.2195333391,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-09-08T00:00:00",
    "end_date": "2025-09-21T00:00:00",
    "net_sales": 54031.52,
    "MP_LaborCost": 15161.72,
    "MP_TotalLaborCostExcludingTips": 11861.72,
    "total_labor_cost": 11861.72,
    "labor_cost_pct": 21.953333905838665,
    "sales_per_labor_hour": 50.322734469591126,
    "labor_cost_per_hour": 11.04751792865791,
    "overtime_pct": 6.696470149948776,
    "period_midpoint": "2025-09-14T12:00:00"
  },
  {
    "Period": "9/22-10/5",
    "Tips": 6850.79,
    "lv_net_sales": 63811.66,
    "lv_totalLaborcost": 28046.18,
    "Tips_Distributed": 6843.72,
    "if_match": 717.700879120878,
    "LV_LaborCost_no_tips": 21202.46,
    "labor_cost/net_sales": 0.3322662347,
    "total_Labor_hour": 1091.9,
    "OT_hour": 66.7,
    "SPLH": 60.3286813186814,
    "HC": 16.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": null,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": 3229.5,
    "Payroll_NonRegularTotal": 3229.5,
    "Other": -3300.0,
    "NV_TotalLaborCostExcludingTips": 21131.96,
    "TotalLaborCost/NetSales": 0.331161421,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-09-22T00:00:00",
    "end_date": "2025-10-05T00:00:00",
    "net_sales": 63811.66,
    "MP_LaborCost": 21202.46,
    "MP_TotalLaborCostExcludingTips": 21131.96,
    "total_labor_cost": 21131.96,
    "labor_cost_pct": 33.11614209691457,
    "sales_per_labor_hour": 58.440937814818206,
    "labor_cost_per_hour": 19.353384009524678,
    "overtime_pct": 6.1086180053118415,
    "period_midpoint": "2025-09-28T12:00:00"
  },
  {
    "Period": "10/6-10/19",
    "Tips": 7928.39,
    "lv_net_sales": 73528.32,
    "lv_totalLaborcost": 29629.58,
    "Tips_Distributed": 7690.0,
    "if_match": 717.700879120878,
    "LV_LaborCost_no_tips": 21939.58,
    "labor_cost/net_sales": 0.2983827184,
    "total_Labor_hour": 1131.5,
    "OT_hour": 99.0,
    "SPLH": 60.3286813186814,
    "HC": 16.0,
    "Payroll_Dismissal": 822.5,
    "Payroll_OffCycle": null,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 822.5,
    "Other": -3300.0,
    "NV_TotalLaborCostExcludingTips": 19462.08,
    "TotalLaborCost/NetSales": 0.2646882181,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-10-06T00:00:00",
    "end_date": "2025-10-19T00:00:00",
    "net_sales": 73528.32,
    "MP_LaborCost": 21939.58,
    "MP_TotalLaborCostExcludingTips": 19462.08,
    "total_labor_cost": 19462.08,
    "labor_cost_pct": 26.468821809066224,
    "sales_per_labor_hour": 64.98304904993373,
    "labor_cost_per_hour": 17.200247459125055,
    "overtime_pct": 8.749447635881573,
    "period_midpoint": "2025-10-12T12:00:00"
  },
  {
    "Period": "10/20-11/02",
    "Tips": 7956.28,
    "lv_net_sales": 73362.51,
    "lv_totalLaborcost": 31392.89,
    "Tips_Distributed": 7862.0,
    "if_match": 717.700879120878,
    "LV_LaborCost_no_tips": 23530.89,
    "labor_cost/net_sales": 0.3207481587,
    "total_Labor_hour": 1175.2,
    "OT_hour": 215.3,
    "SPLH": 60.3286813186814,
    "HC": 18.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": null,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 0.0,
    "Other": -3300.0,
    "NV_TotalLaborCostExcludingTips": 20230.89,
    "TotalLaborCost/NetSales": 0.2757660554,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-10-20T00:00:00",
    "end_date": "2025-11-02T00:00:00",
    "net_sales": 73362.51,
    "MP_LaborCost": 23530.89,
    "MP_TotalLaborCostExcludingTips": 20230.89,
    "total_labor_cost": 20230.89,
    "labor_cost_pct": 27.576605544166906,
    "sales_per_labor_hour": 62.42555309734512,
    "labor_cost_per_hour": 17.214848536419332,
    "overtime_pct": 18.320285908781482,
    "period_midpoint": "2025-10-26T12:00:00"
  },
  {
    "Period": "11/03-11/16",
    "Tips": 8262.8,
    "lv_net_sales": 80440.67,
    "lv_totalLaborcost": 31669.95,
    "Tips_Distributed": 8222.0,
    "if_match": 717.700879120878,
    "LV_LaborCost_no_tips": 23447.95,
    "labor_cost/net_sales": 0.2914937183,
    "total_Labor_hour": 1150.81,
    "OT_hour": 208.89,
    "SPLH": 60.3286813186814,
    "HC": 16.0,
    "Payroll_Dismissal": 317.32,
    "Payroll_OffCycle": 406.11,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 723.43,
    "Other": -3300.0,
    "NV_TotalLaborCostExcludingTips": 20871.38,
    "TotalLaborCost/NetSales": 0.2594630303,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-11-03T00:00:00",
    "end_date": "2025-11-16T00:00:00",
    "net_sales": 80440.67,
    "MP_LaborCost": 23447.95,
    "MP_TotalLaborCostExcludingTips": 20871.38,
    "total_labor_cost": 20871.38,
    "labor_cost_pct": 25.946303033030432,
    "sales_per_labor_hour": 69.89917536343967,
    "labor_cost_per_hour": 18.136251857387407,
    "overtime_pct": 18.151562812280044,
    "period_midpoint": "2025-11-09T12:00:00"
  },
  {
    "Period": "11/17-11/30",
    "Tips": 9702.59,
    "lv_net_sales": 90183.47,
    "lv_totalLaborcost": 34467.39,
    "Tips_Distributed": 9702.0,
    "if_match": 717.700879120878,
    "LV_LaborCost_no_tips": 24765.39,
    "labor_cost/net_sales": 0.2746111898,
    "total_Labor_hour": 1225.28,
    "OT_hour": 220.28,
    "SPLH": 60.3286813186814,
    "HC": 16.0,
    "Payroll_Dismissal": null,
    "Payroll_OffCycle": null,
    "Payroll_NewHire": null,
    "Payroll_NonGusto": null,
    "Payroll_Fixing": null,
    "Payroll_Bonus": null,
    "Payroll_NonRegularTotal": 0.0,
    "Other": -3300.0,
    "NV_TotalLaborCostExcludingTips": 21465.39,
    "TotalLaborCost/NetSales": 0.2380191181,
    "Unnamed: 22": null,
    "Unnamed: 23": null,
    "start_date": "2025-11-17T00:00:00",
    "end_date": "2025-11-30T00:00:00",
    "net_sales": 90183.47,
    "MP_LaborCost": 24765.39,
    "MP_TotalLaborCostExcludingTips": 21465.39,
    "total_labor_cost": 21465.39,
    "labor_cost_pct": 23.801911813772524,
    "sales_per_labor_hour": 73.60233579263516,
    "labor_cost_per_hour": 17.51876305823975,
    "overtime_pct": 17.977931574823714,
    "period_midpoint": "2025-11-23T12:00:00"
  }
]
    </script>

    <div class="section">
        <h2>执行摘要</h2>
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="label">总净销售额</div>
                <div class="value">$1,861,326.26</div>
            </div>
            <div class="metric-card">
                <div class="label">总人工成本</div>
                <div class="value">$554,959.39</div>
            </div>
            <div class="metric-card">
                <div class="label">平均人工成本占比</div>
                <div class="value">29.82%</div>
            </div>
            <div class="metric-card">
                <div class="label">总人工工时</div>
                <div class="value">27,990.68</div>
            </div>
            <div class="metric-card">
                <div class="label">平均每小时销售额</div>
                <div class="value">$66.22</div>
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>可视化分析</h2>
        <div class="chart-tabs">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="switchTab('total', this)">总计</button>
                <button class="tab-button" onclick="switchTab('labor_cost', this)">Labor Cost</button>
                <button class="tab-button" onclick="switchTab('splh', this)">Sales Per Labor Hour</button>
                <button class="tab-button" onclick="switchTab('overtime', this)">Overtime</button>
            </div>
            
            <div id="tab-total" class="tab-content active">
                <div class="chart-image">
                    <canvas id="totalChart" style="max-width: 100%; height: 500px;"></canvas>
                </div>
            </div>
            
            <div id="tab-labor_cost" class="tab-content">
                <div class="chart-image">
                    <canvas id="laborCostChart" style="max-width: 100%; height: 500px;"></canvas>
                </div>
            </div>
            
            <div id="tab-splh" class="tab-content">
                <div class="chart-image">
                    <canvas id="splhChart" style="max-width: 100%; height: 500px;"></canvas>
                </div>
            </div>
            
            <div id="tab-overtime" class="tab-content">
                <div class="chart-image">
                    <canvas id="overtimeChart" style="max-width: 100%; height: 500px;"></canvas>
                </div>
            </div>
        </div>
    </div>
        <div class="section">
        <h2>关键指标</h2>
        <table id="keyMetricsTable">
            <tr>
                <th>指标</th>
                <th>数值</th>
            </tr>
            <tr>
                <td>分析时间段数</td>
                <td>24 个</td>
            </tr>
            <tr>
                <td>平均人工成本占比</td>
                <td>30.78%</td>
            </tr>
            <tr>
                <td>最低人工成本占比</td>
                <td>20.53% (时间段: 2/24-3/9)</td>
            </tr>
            <tr>
                <td>最高人工成本占比</td>
                <td>52.28% (时间段: 8/11-8/24)</td>
            </tr>
            <tr>
                <td>标准差</td>
                <td>7.18%</td>
            </tr>
            <tr>
                <td>平均每小时销售额 (SPLH)</td>
                <td>$66.22</td>
            </tr>
            <tr>
                <td>最佳 SPLH</td>
                <td>$103.19 (时间段: 2/24-3/9)</td>
            </tr>
            <tr>
                <td>最差 SPLH</td>
                <td>$37.81 (时间段: 8/11-8/24)</td>
            </tr>
            <tr>
                <td>平均加班工时占比</td>
                <td>15.68%</td>
            </tr>
            <tr>
                <td>总加班工时</td>
                <td>4,441.93 小时</td>
            </tr>
            <tr>
                <td>平均员工数量</td>
                <td>17.3 人</td>
            </tr>
        </table>
    </div>

    <div class="section">
        <h2>按时间段详细分析</h2>
        <div style="margin-bottom: 20px;">
            <label for="periodFilter" style="font-weight: bold; margin-right: 10px;">按Payroll筛选时间段:</label>
            <select id="periodFilter" onchange="filterTable()" style="padding: 8px 15px; font-size: 14px; border: 2px solid #667eea; border-radius: 5px; cursor: pointer;">
                <option value="all">全部时间段</option>
                <option value="12/30-1/12">12/30-1/12</option>
                <option value="1/13-1/26">1/13-1/26</option>
                <option value="1/27-2/9">1/27-2/9</option>
                <option value="2/10-2/23">2/10-2/23</option>
                <option value="2/24-3/9">2/24-3/9</option>
                <option value="3/10-3/23">3/10-3/23</option>
                <option value="3/24-4/6">3/24-4/6</option>
                <option value="4/7-4/20">4/7-4/20</option>
                <option value="4/21-5/4">4/21-5/4</option>
                <option value="5/5-5/18">5/5-5/18</option>
                <option value="5/19-6/1">5/19-6/1</option>
                <option value="6/2-6/15">6/2-6/15</option>
                <option value="6/16-6/29">6/16-6/29</option>
                <option value="6/30-7/13">6/30-7/13</option>
                <option value="7/14-7/27">7/14-7/27</option>
                <option value="7/28-8/10">7/28-8/10</option>
                <option value="8/11-8/24">8/11-8/24</option>
                <option value="8/25-9/7">8/25-9/7</option>
                <option value="9/8-9/21">9/8-9/21</option>
                <option value="9/22-10/5">9/22-10/5</option>
                <option value="10/6-10/19">10/6-10/19</option>
                <option value="10/20-11/02">10/20-11/02</option>
                <option value="11/03-11/16">11/03-11/16</option>
                <option value="11/17-11/30">11/17-11/30</option>
            
    </select>
        </div>
        <table id="periodTable">
            <thead>
                <tr>
                    <th>时间段</th>
                    <th>净销售额</th>
                    <th>人工成本</th>
                    <th>人工成本占比</th>
                    <th>每小时销售额</th>
                    <th>总工时</th>
                    <th>加班工时</th>
                    <th>加班占比</th>
                    <th>员工数量</th>
                    <th>OT涨跌幅</th>
                    <th>人工成本涨跌幅</th>
                </tr>
            </thead>
            <tbody id="periodTableBody">

            <tr data-period="12/30-1/12">
                <td>12/30-1/12</td>
                <td>$86,084.65</td>
                <td>$23,776.24</td>
                <td>27.62%</td>
                <td>$78.27</td>
                <td>1,099.82</td>
                <td>194.33</td>
                <td>17.67%</td>
                <td>20</td>
                <td style="color: #333; font-weight: bold;">-</td>
                <td style="color: #333; font-weight: bold;">-</td>
            </tr>

            <tr data-period="1/13-1/26">
                <td>1/13-1/26</td>
                <td>$88,065.24</td>
                <td>$26,305.02</td>
                <td>29.87%</td>
                <td>$69.65</td>
                <td>1,264.31</td>
                <td>261.59</td>
                <td>20.69%</td>
                <td>21</td>
                <td style="color: #e74c3c; font-weight: bold;">+34.61%</td>
                <td style="color: #e74c3c; font-weight: bold;">+10.64%</td>
            </tr>

            <tr data-period="1/27-2/9">
                <td>1/27-2/9</td>
                <td>$73,634.73</td>
                <td>$24,809.19</td>
                <td>33.69%</td>
                <td>$63.67</td>
                <td>1,156.46</td>
                <td>201.47</td>
                <td>17.42%</td>
                <td>21</td>
                <td style="color: #27ae60; font-weight: bold;">-22.98%</td>
                <td style="color: #27ae60; font-weight: bold;">-5.69%</td>
            </tr>

            <tr data-period="2/10-2/23">
                <td>2/10-2/23</td>
                <td>$96,843.33</td>
                <td>$32,677.26</td>
                <td>33.74%</td>
                <td>$82.39</td>
                <td>1,175.45</td>
                <td>230.58</td>
                <td>19.62%</td>
                <td>17</td>
                <td style="color: #e74c3c; font-weight: bold;">+14.45%</td>
                <td style="color: #e74c3c; font-weight: bold;">+31.71%</td>
            </tr>

            <tr data-period="2/24-3/9">
                <td>2/24-3/9</td>
                <td>$118,021.94</td>
                <td>$24,226.05</td>
                <td>20.53%</td>
                <td>$103.19</td>
                <td>1,143.72</td>
                <td>222.58</td>
                <td>19.46%</td>
                <td>15</td>
                <td style="color: #27ae60; font-weight: bold;">-3.47%</td>
                <td style="color: #27ae60; font-weight: bold;">-25.86%</td>
            </tr>

            <tr data-period="3/10-3/23">
                <td>3/10-3/23</td>
                <td>$129,865.81</td>
                <td>$30,256.81</td>
                <td>23.30%</td>
                <td>$91.99</td>
                <td>1,411.67</td>
                <td>374.90</td>
                <td>26.56%</td>
                <td>17</td>
                <td style="color: #e74c3c; font-weight: bold;">+68.43%</td>
                <td style="color: #e74c3c; font-weight: bold;">+24.89%</td>
            </tr>

            <tr data-period="3/24-4/6">
                <td>3/24-4/6</td>
                <td>$108,307.51</td>
                <td>$29,201.86</td>
                <td>26.96%</td>
                <td>$86.92</td>
                <td>1,246.04</td>
                <td>256.39</td>
                <td>20.58%</td>
                <td>19</td>
                <td style="color: #27ae60; font-weight: bold;">-31.61%</td>
                <td style="color: #27ae60; font-weight: bold;">-3.49%</td>
            </tr>

            <tr data-period="4/7-4/20">
                <td>4/7-4/20</td>
                <td>$74,457.25</td>
                <td>$33,714.64</td>
                <td>45.28%</td>
                <td>$58.49</td>
                <td>1,273.00</td>
                <td>235.50</td>
                <td>18.50%</td>
                <td>17</td>
                <td style="color: #27ae60; font-weight: bold;">-8.15%</td>
                <td style="color: #e74c3c; font-weight: bold;">+15.45%</td>
            </tr>

            <tr data-period="4/21-5/4">
                <td>4/21-5/4</td>
                <td>$91,729.06</td>
                <td>$27,156.18</td>
                <td>29.60%</td>
                <td>$86.25</td>
                <td>1,063.50</td>
                <td>200.00</td>
                <td>18.81%</td>
                <td>16</td>
                <td style="color: #27ae60; font-weight: bold;">-15.07%</td>
                <td style="color: #27ae60; font-weight: bold;">-19.45%</td>
            </tr>

            <tr data-period="5/5-5/18">
                <td>5/5-5/18</td>
                <td>$87,248.43</td>
                <td>$26,254.80</td>
                <td>30.09%</td>
                <td>$75.51</td>
                <td>1,155.50</td>
                <td>202.00</td>
                <td>17.48%</td>
                <td>17</td>
                <td style="color: #e74c3c; font-weight: bold;">+1.00%</td>
                <td style="color: #27ae60; font-weight: bold;">-3.32%</td>
            </tr>

            <tr data-period="5/19-6/1">
                <td>5/19-6/1</td>
                <td>$74,619.19</td>
                <td>$24,659.62</td>
                <td>33.05%</td>
                <td>$64.69</td>
                <td>1,153.41</td>
                <td>189.80</td>
                <td>16.46%</td>
                <td>17</td>
                <td style="color: #27ae60; font-weight: bold;">-6.04%</td>
                <td style="color: #27ae60; font-weight: bold;">-6.08%</td>
            </tr>

            <tr data-period="6/2-6/15">
                <td>6/2-6/15</td>
                <td>$65,239.25</td>
                <td>$24,699.57</td>
                <td>37.86%</td>
                <td>$60.22</td>
                <td>1,083.40</td>
                <td>156.34</td>
                <td>14.43%</td>
                <td>17</td>
                <td style="color: #27ae60; font-weight: bold;">-17.63%</td>
                <td style="color: #e74c3c; font-weight: bold;">+0.16%</td>
            </tr>

            <tr data-period="6/16-6/29">
                <td>6/16-6/29</td>
                <td>$60,471.08</td>
                <td>$17,237.53</td>
                <td>28.51%</td>
                <td>$51.64</td>
                <td>1,171.05</td>
                <td>151.45</td>
                <td>12.93%</td>
                <td>17</td>
                <td style="color: #27ae60; font-weight: bold;">-3.13%</td>
                <td style="color: #27ae60; font-weight: bold;">-30.21%</td>
            </tr>

            <tr data-period="6/30-7/13">
                <td>6/30-7/13</td>
                <td>$63,599.00</td>
                <td>$17,036.63</td>
                <td>26.79%</td>
                <td>$57.62</td>
                <td>1,103.86</td>
                <td>182.63</td>
                <td>16.54%</td>
                <td>16</td>
                <td style="color: #e74c3c; font-weight: bold;">+20.59%</td>
                <td style="color: #27ae60; font-weight: bold;">-1.17%</td>
            </tr>

            <tr data-period="7/14-7/27">
                <td>7/14-7/27</td>
                <td>$57,546.81</td>
                <td>$18,449.38</td>
                <td>32.06%</td>
                <td>$49.04</td>
                <td>1,173.50</td>
                <td>123.00</td>
                <td>10.48%</td>
                <td>19</td>
                <td style="color: #27ae60; font-weight: bold;">-32.65%</td>
                <td style="color: #e74c3c; font-weight: bold;">+8.29%</td>
            </tr>

            <tr data-period="7/28-8/10">
                <td>7/28-8/10</td>
                <td>$52,089.50</td>
                <td>$19,519.26</td>
                <td>37.47%</td>
                <td>$45.55</td>
                <td>1,143.60</td>
                <td>134.80</td>
                <td>11.79%</td>
                <td>18</td>
                <td style="color: #e74c3c; font-weight: bold;">+9.59%</td>
                <td style="color: #e74c3c; font-weight: bold;">+5.80%</td>
            </tr>

            <tr data-period="8/11-8/24">
                <td>8/11-8/24</td>
                <td>$44,574.39</td>
                <td>$23,304.35</td>
                <td>52.28%</td>
                <td>$37.81</td>
                <td>1,179.00</td>
                <td>124.00</td>
                <td>10.52%</td>
                <td>19</td>
                <td style="color: #27ae60; font-weight: bold;">-8.01%</td>
                <td style="color: #e74c3c; font-weight: bold;">+19.39%</td>
            </tr>

            <tr data-period="8/25-9/7">
                <td>8/25-9/7</td>
                <td>$53,570.94</td>
                <td>$16,651.58</td>
                <td>31.08%</td>
                <td>$46.79</td>
                <td>1,145.00</td>
                <td>118.50</td>
                <td>10.35%</td>
                <td>15</td>
                <td style="color: #27ae60; font-weight: bold;">-4.44%</td>
                <td style="color: #27ae60; font-weight: bold;">-28.55%</td>
            </tr>

            <tr data-period="9/8-9/21">
                <td>9/8-9/21</td>
                <td>$54,031.52</td>
                <td>$11,861.72</td>
                <td>21.95%</td>
                <td>$50.32</td>
                <td>1,073.70</td>
                <td>71.90</td>
                <td>6.70%</td>
                <td>15</td>
                <td style="color: #27ae60; font-weight: bold;">-39.32%</td>
                <td style="color: #27ae60; font-weight: bold;">-28.77%</td>
            </tr>

            <tr data-period="9/22-10/5">
                <td>9/22-10/5</td>
                <td>$63,811.66</td>
                <td>$21,131.96</td>
                <td>33.12%</td>
                <td>$58.44</td>
                <td>1,091.90</td>
                <td>66.70</td>
                <td>6.11%</td>
                <td>16</td>
                <td style="color: #27ae60; font-weight: bold;">-7.23%</td>
                <td style="color: #e74c3c; font-weight: bold;">+78.15%</td>
            </tr>

            <tr data-period="10/6-10/19">
                <td>10/6-10/19</td>
                <td>$73,528.32</td>
                <td>$19,462.08</td>
                <td>26.47%</td>
                <td>$64.98</td>
                <td>1,131.50</td>
                <td>99.00</td>
                <td>8.75%</td>
                <td>16</td>
                <td style="color: #e74c3c; font-weight: bold;">+48.43%</td>
                <td style="color: #27ae60; font-weight: bold;">-7.90%</td>
            </tr>

            <tr data-period="10/20-11/02">
                <td>10/20-11/02</td>
                <td>$73,362.51</td>
                <td>$20,230.89</td>
                <td>27.58%</td>
                <td>$62.43</td>
                <td>1,175.20</td>
                <td>215.30</td>
                <td>18.32%</td>
                <td>18</td>
                <td style="color: #e74c3c; font-weight: bold;">+117.47%</td>
                <td style="color: #e74c3c; font-weight: bold;">+3.95%</td>
            </tr>

            <tr data-period="11/03-11/16">
                <td>11/03-11/16</td>
                <td>$80,440.67</td>
                <td>$20,871.38</td>
                <td>25.95%</td>
                <td>$69.90</td>
                <td>1,150.81</td>
                <td>208.89</td>
                <td>18.15%</td>
                <td>16</td>
                <td style="color: #27ae60; font-weight: bold;">-2.98%</td>
                <td style="color: #e74c3c; font-weight: bold;">+3.17%</td>
            </tr>

            <tr data-period="11/17-11/30">
                <td>11/17-11/30</td>
                <td>$90,183.47</td>
                <td>$21,465.39</td>
                <td>23.80%</td>
                <td>$73.60</td>
                <td>1,225.28</td>
                <td>220.28</td>
                <td>17.98%</td>
                <td>16</td>
                <td style="color: #e74c3c; font-weight: bold;">+5.45%</td>
                <td style="color: #e74c3c; font-weight: bold;">+2.85%</td>
            </tr>

            </tbody>
        </table>
    </div>
    
    <div class="section">
        <h2>月度汇总</h2>
        <table>
            <thead>
                <tr>
                    <th>月份</th>
                    <th>净销售额</th>
                    <th>人工成本</th>
                    <th>人工成本占比</th>
                    <th>每小时销售额</th>
                    <th>总工时</th>
                    <th>加班工时</th>
                    <th>平均员工数量</th>
                </tr>
            </thead>
            <tbody id="monthlyTableBody">

            <tr>
                <td>2024-12</td>
                <td>$86,084.65</td>
                <td>$23,776.24</td>
                <td>27.62%</td>
                <td>$78.27</td>
                <td>1,099.82</td>
                <td>194.33</td>
                <td>20.0</td>
            </tr>

            <tr>
                <td>2025-01</td>
                <td>$161,699.97</td>
                <td>$51,114.21</td>
                <td>31.61%</td>
                <td>$66.80</td>
                <td>2,420.77</td>
                <td>463.06</td>
                <td>21.0</td>
            </tr>

            <tr>
                <td>2025-02</td>
                <td>$214,865.27</td>
                <td>$56,903.32</td>
                <td>26.48%</td>
                <td>$92.65</td>
                <td>2,319.17</td>
                <td>453.16</td>
                <td>16.0</td>
            </tr>

            <tr>
                <td>2025-03</td>
                <td>$238,173.32</td>
                <td>$59,458.67</td>
                <td>24.96%</td>
                <td>$89.62</td>
                <td>2,657.71</td>
                <td>631.29</td>
                <td>18.0</td>
            </tr>

            <tr>
                <td>2025-04</td>
                <td>$166,186.31</td>
                <td>$60,870.82</td>
                <td>36.63%</td>
                <td>$71.13</td>
                <td>2,336.50</td>
                <td>435.50</td>
                <td>16.5</td>
            </tr>

            <tr>
                <td>2025-05</td>
                <td>$161,867.62</td>
                <td>$50,914.42</td>
                <td>31.45%</td>
                <td>$70.11</td>
                <td>2,308.91</td>
                <td>391.80</td>
                <td>17.0</td>
            </tr>

            <tr>
                <td>2025-06</td>
                <td>$189,309.33</td>
                <td>$58,973.73</td>
                <td>31.15%</td>
                <td>$56.37</td>
                <td>3,358.31</td>
                <td>490.42</td>
                <td>16.7</td>
            </tr>

            <tr>
                <td>2025-07</td>
                <td>$109,636.31</td>
                <td>$37,968.64</td>
                <td>34.63%</td>
                <td>$47.32</td>
                <td>2,317.10</td>
                <td>257.80</td>
                <td>18.5</td>
            </tr>

            <tr>
                <td>2025-08</td>
                <td>$98,145.33</td>
                <td>$39,955.93</td>
                <td>40.71%</td>
                <td>$42.23</td>
                <td>2,324.00</td>
                <td>242.50</td>
                <td>17.0</td>
            </tr>

            <tr>
                <td>2025-09</td>
                <td>$117,843.18</td>
                <td>$32,993.68</td>
                <td>28.00%</td>
                <td>$54.42</td>
                <td>2,165.60</td>
                <td>138.60</td>
                <td>15.5</td>
            </tr>

            <tr>
                <td>2025-10</td>
                <td>$146,890.83</td>
                <td>$39,692.97</td>
                <td>27.02%</td>
                <td>$63.68</td>
                <td>2,306.70</td>
                <td>314.30</td>
                <td>17.0</td>
            </tr>

            <tr>
                <td>2025-11</td>
                <td>$170,624.14</td>
                <td>$42,336.77</td>
                <td>24.81%</td>
                <td>$71.81</td>
                <td>2,376.09</td>
                <td>429.17</td>
                <td>16.0</td>
            </tr>

            </tbody>
        </table>
    </div>
    
    <div class="section">
        <h2>洞察与建议</h2>
        
        <div class="highlight" id="bestPeriod">
            <h3>1. 最佳表现时间段：{best_period['Period']}</h3>
            <ul>
                <li>人工成本占比：{best_period['labor_cost_pct']:.2f}%</li>
                <li>每小时销售额：${best_period['sales_per_labor_hour']:.2f}</li>
                <li>关键因素：员工数量 {best_period['HC']:.0f} 人，加班占比 {best_period['overtime_pct']:.2f}%</li>
            </ul>
        </div>
        
        <div class="insight" id="worstPeriod">
            <h3>2. 最差表现时间段：{worst_period['Period']}</h3>
            <ul>
                <li>人工成本占比：{worst_period['labor_cost_pct']:.2f}%</li>
                <li>每小时销售额：${worst_period['sales_per_labor_hour']:.2f}</li>
                <li>关键因素：员工数量 {worst_period['HC']:.0f} 人，加班占比 {worst_period['overtime_pct']:.2f}%</li>
            </ul>
        </div>
        
        <div class="insight" id="correlation">
            <h3>3. 销售额-人工成本相关性：{correlation:.3f}</h3>
<p>中等相关 - 存在一定的效率提升空间</p>
        <div class="insight" id="overtime">
            <h3>4. 加班工时状况</h3>
            <p>平均加班工时占比为 15.68%，处于可接受范围内。</p>
        </div>

        <div class="insight" id="trend">
            <h3>5. 趋势分析</h3>
            <p>人工效率趋势：<strong>改善</strong></p>
            <ul>
                <li>前半段平均：30.97%</li>
                <li>后半段平均：30.59%</li>
            </ul>

        </div>
    </div>
    
    <div class="footer">
        <p>本报告由人工效率分析系统自动生成</p>
        <p>门店：{store_name if store_name else '未知'}</p>
    </div>
</body>
</html>
